<!-- views/index.ejs -->
<!doctype html>
<html lang="en">

<head>
    <!-- head -->
    <% include include/head %>
    <!-- load custom carousel stylesheet -->
    <link rel="stylesheet" href="/css/carousel.css">
</head>


<body class="home">

    <!-- navbar header -->
    <% include include/nav %>

    <!-- flash messages -->
    <% include include/flash %>

    <!-- carousel -->
    <% include include/carousel-small %>
    <div>

        <div class="container">

            <div class="row margin-top-2">
                <h2>Our Menu</h2>
            </div>

            <div class="row margin-top-2">
                <div class="btn-group" data-toggle="buttons">
                    <label class="btn active">
                        <input type="checkbox" class="filter-checkbox filter-all"
                               autocomplete="off" value="*" checked> All Items
                    </label>
                    <% locals._.each(categories, function (category) { %>
                        <label class="btn">
                            <input type="checkbox" class="filter-checkbox filter-category" autocomplete="off"
                                   value=".<%= category.slug  %>"> <%= category.title %>
                        </label>
                    <% }) %>
                </div>
            </div>

            <div class="row featured grid margin-top-2">
                <% locals._.each(items, function (item) { %>
                    <a class="col-xs-12 col-sm-4 col-md-4 col-lg-3 margin-top-1 element-item <%= item.category.slug %>" href="/menu/<%= item.id %>">
                        <div class="featured-thumbnail">
                            <img src="<%= item.imageUri %>" class="img-circle img-thumbnail">
                            <h2><%= item.title %> | $<%= item.basePrice.toFixed(2) %></h2>
                            <hr/>
                            <p><%= item.shortDesc %></p>
                        </div>
                    </a>
                <% }) %>
            </div>

        </div>

    </div>

    <!-- javascript -->
    <% include include/scripts %>
    <script src="/js/isotope.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {

            var $grid = $('.grid').isotope({
                itemSelector: 'a.element-item',
                layoutMode: 'fitRows'
            });

            $('.filter-checkbox').on('change', function () {
                var filter = '*';
                if($(this).hasClass('filter-all')) {
                    console.log('filterall')
                    $('.filter-category').removeAttr('checked').parent().toggleClass('active');
                } else {
                    console.log('filtercategory')
                    $('.filter-all').removeAttr('checked').parent().toggleClass('active');
                    filter = $('input:checkbox:checked.filter-category').map(function () {
                        return this.value
                    }).get().join(', ')
                }
                $grid.isotope({ filter: filter });
            });
        });
    </script>

</body>
</html>
